---
// 播客/文章卡片组件
import ResponsiveImage from './ResponsiveImage.astro';

interface Props {
    title: string;
    description: string;
    image: string;
    slug: string;
    type: string;
    width?: number;
    height?: number;
}

// 1. 首先解析所有props
const props = Astro.props;

// 2. 提取所需属性并设置默认值
const title = props.title;
const description = props.description;
const image = props.image;
const slug = props.slug;
const type = props.type;
const width = props.width || 600;
const height = props.height || 400;

// 3. 计算辅助变量
const basePath = type === '播客' ? 'podcasts' : 'articles';
const cleanSlug = slug.replace(new RegExp(`^${basePath}/`), '');

// 4. 最后生成链接变量
const cardLink: string = `/${basePath}/${cleanSlug}`.replace(//+/g, '/');
---

<a href={cardLink} class="block bg-white rounded-lg overflow-hidden shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 hover:scale-105">
    <div class="relative h-48 overflow-hidden">
        <ResponsiveImage
            src={image}
            alt={title}
            width={width}
            height={height}
            loading="lazy"
            decoding="async"
        />
    </div>
    <div class="p-6">
        <h3 class="text-xl font-bold mb-3 text-gray-800 hover:text-blue-600 transition-colors duration-300">{title}</h3>
        <p class="text-gray-600 line-clamp-3">{description}</p>
    </div>
</a>