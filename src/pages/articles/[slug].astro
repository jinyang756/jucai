---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

// 获取所有文章条目，用于生成静态页面路径
export async function getStaticPaths() {
  const articles = await getCollection('articles');
  return articles.map((article: CollectionEntry<'articles'>) => ({
    params: { slug: article.slug },
    props: { article },
  }));
}

// 获取当前页面的文章数据
interface Props {
  article: CollectionEntry<'articles'>;
}
const { article } = Astro.props;
const { Content } = await article.render();
---
<BaseLayout title={article.data.title} description={article.data.description || '专业投资分析文章 - ' + article.data.title}>
    <!-- 主内容区域 -->
    <main class="container mx-auto px-4 py-8 md:py-12 lg:py-16 max-w-4xl">
        <!-- 文章标题与元信息 -->
        <section class="bg-white p-6 md:p-8 rounded-lg shadow-md mb-8">
            <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-3 leading-tight">
                {article.data.title}
            </h1>
            <p class="text-gray-500 text-sm md:text-base mb-4">
                发布日期：{new Date(article.data.publishDate).toLocaleDateString('zh-CN')}
            </p>
            <!-- 文章封面图 -->
            <img src={article.data.coverImage || '/images/article-default.jpg'} alt={`文章封面图：${article.data.title}`} class="w-full h-auto rounded-md shadow-sm mb-6 object-cover">
        </section>

        <!-- 文章内容 -->
        <section class="bg-white p-6 md:p-8 rounded-lg shadow-md mb-8">
            <div class="prose prose-lg max-w-none text-gray-700 leading-relaxed">
                <Content /> <!-- 渲染Markdown内容 -->
            </div>
        </section>


    </main>
</BaseLayout>